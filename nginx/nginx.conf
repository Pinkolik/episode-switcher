events
{
	worker_connections 1024; ## Default: 1024
}

http
{
    server {
        listen 80;

        server_name episode-switcher.ru;
        server_tokens off;

        location / {
            return 301 https://episode-switcher.ru$request_uri;
        }
    }

	server
	{
		# simple reverse-proxy
        listen 443 ssl;
        server_name  episode-switcher.ru;
        ssl_certificate /etc/nginx/certs/fullchain.pem;
        ssl_certificate_key /etc/nginx/certs/privkey.pem;

	    underscores_in_headers on;

		location /api/alisa
		{
			proxy_pass http://app:8080/api/alisa;
		}

		location /openid-connect/token
		{
			proxy_pass http://keycloak:8080/realms/EpisodeSwitcher/protocol/openid-connect/token;
			proxy_pass_request_headers on;
		}

		location /openid-connect/auth
		{
			proxy_pass http://keycloak:8080/realms/EpisodeSwitcher/protocol/openid-connect/auth;
			proxy_pass_request_headers on;
		}
	}
}